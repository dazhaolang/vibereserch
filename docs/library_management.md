# 文献库批量操作与任务关联说明

## 批量操作

新版文献库在左侧工具栏提供以下批量操作：

- 收藏/取消收藏：使用上方按钮直接调用 `/api/literature/batch/star`。
- 归档/取消归档：`批量操作` 菜单中调用 `/api/literature/batch/archive`。
- 标签管理：`批量操作` 菜单支持添加、移除、替换标签，对应 `/api/literature/batch/tags`，多标签使用逗号分隔。
- 导出：生成 CSV 下载链接，调用 `/api/literature/batch/export`。
- 删除：危险操作，调用 `/api/literature/batch/delete` 并在确认框中提示不可恢复。

操作完成后会自动刷新列表并清空当前选择。

## 文献任务关联

文献详情面板新增“相关任务”分段，读取 `/api/task/literature/{literature_id}`，默认展示任务状态、类型、进度、最近错误以及提取结果标签。

- 列表为懒加载，切换文献时自动刷新。
- 错误提示提供重试按钮，以便在网络或认证失败后快速恢复。
- 当存在提取结果（如摘要、关键词等）时会在条目下方以标签形式提示关键信息。

## 验证建议

1. 后端：确保数据库迁移已执行，启动 FastAPI 时不再重复创建表。
2. 前端：运行 `npm run lint` 确保新增组件满足规范；如需构建执行 `npm run build`。
3. 功能：在界面中勾选若干文献，测试归档、标签、导出和删除操作；在任务中心触发一条文献任务后，检查文献详情页是否出现关联记录。
