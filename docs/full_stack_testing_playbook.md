# å…¨æ ˆæµ‹è¯•æ“ä½œæŒ‡å¼• (VibResearch Platform)

æœ¬æ–‡æ¡£ä¸ºæµ‹è¯•å›¢é˜Ÿæä¾›å®Œæ•´çš„æµ‹è¯•è„šæœ¬æ‰§è¡Œæµç¨‹ã€è¦†ç›–èŒƒå›´è¯´æ˜ã€æ—¥å¿—å½’æ¡£è¦æ±‚ï¼Œä»¥åŠå¤±è´¥æ—¶çš„æŠ¥å‘Šæ¸…å•ã€‚

## ğŸ“‹ æµ‹è¯•è¦†ç›–èŒƒå›´æ€»è§ˆ

### åç«¯ API æµ‹è¯•è¦†ç›–
- **è®¤è¯ç³»ç»Ÿ**: ç™»å½•ã€æ³¨å†Œã€ç”¨æˆ·èµ„æ–™ç®¡ç†ã€JWT TokenéªŒè¯
- **é¡¹ç›®ç®¡ç†**: é¡¹ç›®åˆ›å»ºã€æŸ¥è¯¢ã€ç»Ÿè®¡ã€åˆ é™¤ã€æƒé™æ§åˆ¶
- **æ–‡çŒ®å¤„ç†**: æ–‡çŒ®æ–¹æ³•ã€ç»Ÿè®¡ã€ç”¨æˆ·åº“ç®¡ç†ã€å¤„ç†æµæ°´çº¿
- **ä»»åŠ¡ç³»ç»Ÿ**: ä»»åŠ¡åˆ—è¡¨ã€æ¦‚è§ˆã€ç»Ÿè®¡ã€æ€§èƒ½æŒ‡æ ‡ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†
- **ç›‘æ§æŒ‡æ ‡**: ç³»ç»Ÿå¥åº·ã€ç«¯ç‚¹ç»Ÿè®¡ã€ä¸šåŠ¡æŒ‡æ ‡ã€æ€§èƒ½ç›‘æ§
- **æ€§èƒ½ä¼˜åŒ–**: çŠ¶æ€ç›‘æ§ã€ä»ªè¡¨ç›˜ã€æˆæœ¬åˆ†æã€ä¼˜åŒ–å»ºè®®
- **åä½œå·¥ä½œåŒº**: å·¥ä½œåŒºåˆ›å»ºã€åŠ å…¥ã€æ³¨é‡Šã€æ´å¯Ÿã€æˆå‘˜ç®¡ç†
- **é›†æˆåŠŸèƒ½**: Claude Codeã€æ™ºèƒ½åŠ©æ‰‹ã€çŸ¥è¯†å›¾è°±ã€MCPåè®®
- **ç ”ç©¶æ¨¡å¼**: RAGæ£€ç´¢ã€æ·±åº¦åˆ†æã€è‡ªåŠ¨åŒ–å¤„ç†ä¸‰æ€åˆ‡æ¢

### å‰ç«¯ UI æµ‹è¯•è¦†ç›–
- **ç™»å½•æµç¨‹**: è¡¨å•äº¤äº’ã€APIè°ƒç”¨éªŒè¯ã€é‡å®šå‘ã€é”™è¯¯å¤„ç†
- **é¡¹ç›®å·¥ä½œæµ**: å‰åç«¯æ•°æ®åŒæ­¥ã€UIçŠ¶æ€æ›´æ–°ã€å®æ—¶åˆ·æ–°
- **ä»ªè¡¨ç›˜**: æ•°æ®å±•ç¤ºã€äº¤äº’å“åº”ã€è§†è§‰éªŒè¯ã€å›¾è¡¨æ¸²æŸ“
- **ç”¨æˆ·ä½“éªŒ**: å“åº”å¼è®¾è®¡ã€å¯è®¿é—®æ€§ã€é”™è¯¯è¾¹ç•Œã€åŠ è½½çŠ¶æ€

### å®æ—¶é€šä¿¡æµ‹è¯•è¦†ç›–
- **WebSocketè¿æ¥**: å»ºç«‹ã€ç»´æŒã€æ¶ˆæ¯æ”¶å‘ã€æ–­çº¿é‡è¿
- **å®æ—¶æ¨é€**: äº‹ä»¶é€šçŸ¥ã€çŠ¶æ€åŒæ­¥ã€å¤šç”¨æˆ·åä½œ
- **æ¶ˆæ¯å¤„ç†**: æ¶ˆæ¯æ ¼å¼éªŒè¯ã€ç±»å‹ç»Ÿè®¡ã€å»¶è¿Ÿæµ‹é‡

### æ¨¡å—åŒ–ä¸“é¡¹æµ‹è¯•è¦†ç›–
- **åä½œå·¥ä½œåŒºæ¨¡å—**: å·¥ä½œåŒºç”Ÿå‘½å‘¨æœŸã€æˆå‘˜æƒé™ã€æ³¨é‡Šç³»ç»Ÿ
- **æ€§èƒ½æ´å¯Ÿæ¨¡å—**: é¡¹ç›®è‡ªåŠ¨ç®¡ç†ã€æˆæœ¬ä¼°ç®—ã€æ€§èƒ½å»ºè®®
- **ä¸šåŠ¡å·¥ä½œæµ**: ç«¯åˆ°ç«¯ç”¨æˆ·æ—…ç¨‹ã€æ ¸å¿ƒä¸šåŠ¡åœºæ™¯

## ğŸ”„ æ ‡å‡†æµ‹è¯•æ‰§è¡Œæµç¨‹

### ç¯å¢ƒå‡†å¤‡é˜¶æ®µ
```bash
# 1. è®¾ç½®ç¯å¢ƒå˜é‡
export VIBERESEARCH_BASE_URL="http://localhost:8000"
export VIBERESEARCH_FRONTEND_URL="http://localhost:3000"
export VIBERESEARCH_TEST_EMAIL="test@example.com"
export VIBERESEARCH_TEST_PASSWORD="testpass123"

# 2. åˆå§‹åŒ–ä¾èµ–
python -m venv venv && source venv/bin/activate && pip install -r requirements.txt
cd frontend && npm install && npx playwright install chromium && cd ..

# 3. å¯åŠ¨ä¾èµ–æœåŠ¡ï¼ˆå¯é€‰ï¼‰
docker compose up mysql redis elasticsearch -d

# 4. éªŒè¯æœåŠ¡çŠ¶æ€
curl -f "$VIBERESEARCH_BASE_URL/health" || echo "åç«¯æœåŠ¡æœªå¯åŠ¨"
curl -f "$VIBERESEARCH_FRONTEND_URL" || echo "å‰ç«¯æœåŠ¡æœªå¯åŠ¨"

# 5. åˆ›å»ºå½’æ¡£ç›®å½•
mkdir -p artifacts/$(date +%Y-%m-%d)
```

### æµ‹è¯•æ‰§è¡Œé˜¶æ®µ

#### é˜¶æ®µ 1: åç«¯æ ¸å¿ƒæµ‹è¯• (ä¼˜å…ˆçº§ï¼šé«˜)

##### 1.1 åç«¯å·¥ä½œæµå†’çƒŸæµ‹è¯•
```bash
python3 scripts/backend_workflow_smoke.py \
  --base-url "$VIBERESEARCH_BASE_URL" \
  --email "$VIBERESEARCH_TEST_EMAIL" \
  --password "$VIBERESEARCH_TEST_PASSWORD" \
  --output backend_workflow_results.json

# æœŸæœ›ç»“æœ: 100% PASS (14/14)
# å…³é”®éªŒè¯: æ³¨å†Œâ†’ç™»å½•â†’é¡¹ç›®ç®¡ç†â†’æ€§èƒ½ç›‘æ§â†’æ¸…ç†
```

##### 1.2 API å…¨é‡å›å½’æµ‹è¯•
```bash
python3 scripts/api_regression_suite.py \
  --base-url "$VIBERESEARCH_BASE_URL" \
  --email "$VIBERESEARCH_TEST_EMAIL" \
  --password "$VIBERESEARCH_TEST_PASSWORD" \
  --output api_regression_report.json

# æœŸæœ›ç»“æœ: >95% PASS (47+/48)
# å…³é”®éªŒè¯: 48ä¸ªç«¯ç‚¹çš„çŠ¶æ€ç å’Œå“åº”æ ¼å¼
```

#### é˜¶æ®µ 2: æ¨¡å—ä¸“é¡¹æµ‹è¯• (ä¼˜å…ˆçº§ï¼šä¸­)

##### 2.1 åä½œå·¥ä½œåŒºæ¨¡å—æµ‹è¯•
```bash
python3 scripts/collaboration_workflow_test.py \
  --base-url "$VIBERESEARCH_BASE_URL" \
  --email "$VIBERESEARCH_TEST_EMAIL" \
  --password "$VIBERESEARCH_TEST_PASSWORD" \
  --output collaboration_workflow_results.json

# æœŸæœ›ç»“æœ: 100% PASS (3/3)
# å…³é”®éªŒè¯: workspace_nameå­—æ®µã€æˆå‘˜åˆ—è¡¨ã€å·¥ä½œåŒºID
```

##### 2.2 æ€§èƒ½æ´å¯Ÿæ¨¡å—æµ‹è¯•
```bash
python3 scripts/performance_insights_test.py \
  --base-url "$VIBERESEARCH_BASE_URL" \
  --email "$VIBERESEARCH_TEST_EMAIL" \
  --password "$VIBERESEARCH_TEST_PASSWORD" \
  --output performance_insights_results.json

# æœŸæœ›ç»“æœ: 100% PASS (8/8)
# å…³é”®éªŒè¯: é¡¹ç›®è‡ªåŠ¨åˆ›å»º/æ¸…ç†ã€æˆæœ¬ä¼°ç®—ã€æ€§èƒ½æŒ‡æ ‡
```

#### é˜¶æ®µ 3: å®æ—¶é€šä¿¡æµ‹è¯• (ä¼˜å…ˆçº§ï¼šä¸­)

##### 3.1 WebSocket ç¨³å®šæ€§æµ‹è¯•
```bash
python3 scripts/ws_regression_suite.py \
  --base-url "$VIBERESEARCH_BASE_URL" \
  --email "$VIBERESEARCH_TEST_EMAIL" \
  --password "$VIBERESEARCH_TEST_PASSWORD" \
  --duration 30 \
  --output ws_messages.json

# æœŸæœ›ç»“æœ: è¿æ¥æˆåŠŸã€æ¶ˆæ¯æ¥æ”¶æ­£å¸¸
# å…³é”®éªŒè¯: è¿æ¥å»ºç«‹ã€æ¶ˆæ¯ç±»å‹ç»Ÿè®¡ã€è¿æ¥ç¨³å®šæ€§
```

#### é˜¶æ®µ 4: å‰ç«¯ UI æµ‹è¯• (ä¼˜å…ˆçº§ï¼šé«˜)

##### 4.1 ç™»å½•æµç¨‹éªŒè¯
```bash
node scripts/frontend_login_flow.js

# æœŸæœ›ç»“æœ: ç™»å½•æˆåŠŸã€é‡å®šå‘æ­£å¸¸
# ç”Ÿæˆå·¥ä»¶: frontend_login_success.png (æˆåŠŸ) æˆ– frontend_login_failure.png (å¤±è´¥)
# å…³é”®éªŒè¯: APIè°ƒç”¨çŠ¶æ€200ã€dashboardå†…å®¹æ£€æµ‹
```

##### 4.2 é¡¹ç›®å·¥ä½œæµéªŒè¯
```bash
node scripts/frontend_project_flow.js

# æœŸæœ›ç»“æœ: é¡¹ç›®åˆ›å»ºå¹¶åœ¨UIä¸­æ˜¾ç¤º
# ç”Ÿæˆå·¥ä»¶: frontend_project_workflow.png (æˆåŠŸ) æˆ– frontend_project_workflow_failure.png (å¤±è´¥)
# å…³é”®éªŒè¯: å‰åç«¯æ•°æ®åŒæ­¥ã€é¡¹ç›®åˆ—è¡¨æ›´æ–°
```

#### é˜¶æ®µ 5: ä¸€é”®å…¨æ ˆæµ‹è¯• (å¯é€‰)

##### 5.1 å®Œæ•´ç³»ç»Ÿå¥—ä»¶
```bash
./scripts/run_full_system_suite.sh

# è‡ªåŠ¨æ‰§è¡Œ: pytest â†’ APIå›å½’ â†’ å‰ç«¯lint/build â†’ Playwrightæµ‹è¯•
# ç”Ÿæˆå®Œæ•´çš„artifacts/system_tests/<timestamp>/æŠ¥å‘Š
```

##### 5.2 è‡ªå®šä¹‰å‚æ•°æ‰§è¡Œ
```bash
# è‡ªå®šä¹‰è¿è¡ŒID
RUN_ID=custom-id ./scripts/run_full_system_suite.sh

# è°ƒæ•´å‰ç«¯ç«¯å£
FRONTEND_TEST_PORT=3100 ./scripts/run_full_system_suite.sh

# è¿œç¨‹APIæµ‹è¯•
VIBERESEARCH_BASE_URL=https://api.example.com ./scripts/run_full_system_suite.sh
```

## ğŸ“ æ—¥å¿—å½’æ¡£æ ‡å‡†è¦æ±‚

### æ ‡å‡†å½’æ¡£ç›®å½•ç»“æ„
```
artifacts/YYYY-MM-DD/
â”œâ”€â”€ backend_tests/
â”‚   â”œâ”€â”€ backend_workflow_results.json      # åç«¯å·¥ä½œæµæµ‹è¯•ç»“æœ
â”‚   â”œâ”€â”€ api_regression_report.json         # APIå…¨é‡å›å½’æµ‹è¯•ç»“æœ
â”‚   â”œâ”€â”€ collaboration_workflow_results.json # åä½œå·¥ä½œåŒºæ¨¡å—ç»“æœ
â”‚   â”œâ”€â”€ performance_insights_results.json   # æ€§èƒ½æ´å¯Ÿæ¨¡å—ç»“æœ
â”‚   â””â”€â”€ ws_messages.json                   # WebSocketé€šä¿¡æµ‹è¯•ç»“æœ
â”œâ”€â”€ frontend_tests/
â”‚   â”œâ”€â”€ frontend_login_success.png         # ç™»å½•æµç¨‹æˆåŠŸæˆªå›¾
â”‚   â”œâ”€â”€ frontend_project_workflow.png      # é¡¹ç›®å·¥ä½œæµæˆªå›¾
â”‚   â”œâ”€â”€ frontend_login_failure.png         # ç™»å½•æµç¨‹å¤±è´¥æˆªå›¾(å¦‚æœ‰)
â”‚   â”œâ”€â”€ frontend_project_workflow_failure.png # é¡¹ç›®æµç¨‹å¤±è´¥æˆªå›¾(å¦‚æœ‰)
â”‚   â””â”€â”€ frontend_test_logs.txt            # å‰ç«¯æµ‹è¯•ç»ˆç«¯å®Œæ•´æ—¥å¿—
â”œâ”€â”€ system_tests/
â”‚   â””â”€â”€ artifacts/system_tests/<timestamp>/ # ä¸€é”®å…¨æ ˆæµ‹è¯•å®Œæ•´æŠ¥å‘Š
â”‚       â”œâ”€â”€ backend/pytest.log            # åç«¯å•å…ƒæµ‹è¯•æ—¥å¿—
â”‚       â”œâ”€â”€ backend/backend_server.log     # åç«¯æœåŠ¡è¿è¡Œæ—¥å¿—
â”‚       â”œâ”€â”€ integration/api_regression.log # APIå›å½’æµ‹è¯•æ‰§è¡Œæ—¥å¿—
â”‚       â”œâ”€â”€ integration/api_regression.json # APIæµ‹è¯•ç»“æ„åŒ–ç»“æœ
â”‚       â”œâ”€â”€ frontend/lint.log              # å‰ç«¯ä»£ç æ£€æŸ¥æ—¥å¿—
â”‚       â”œâ”€â”€ frontend/build.log             # å‰ç«¯æ„å»ºæ—¥å¿—
â”‚       â”œâ”€â”€ frontend/playwright.log        # Playwrightæµ‹è¯•æ—¥å¿—
â”‚       â”œâ”€â”€ frontend/test-results/console.log # æµè§ˆå™¨æ§åˆ¶å°æ—¥å¿—
â”‚       â”œâ”€â”€ frontend/test-results/page-errors.log # é¡µé¢é”™è¯¯æ—¥å¿—
â”‚       â”œâ”€â”€ frontend/playwright-report/    # HTMLæµ‹è¯•æŠ¥å‘Šå’Œæˆªå›¾
â”‚       â””â”€â”€ summary.log                   # æ‰§è¡Œæ€»ç»“å’ŒçŠ¶æ€æ±‡æ€»
â”œâ”€â”€ reports/
â”‚   â”œâ”€â”€ TEST_EXECUTION_SUMMARY.md          # æµ‹è¯•æ‰§è¡Œæ€»ç»“æŠ¥å‘Š
â”‚   â”œâ”€â”€ MODULE_TEST_VALIDATION_REPORT.md   # æ¨¡å—æµ‹è¯•éªŒè¯æŠ¥å‘Š
â”‚   â”œâ”€â”€ FAILURE_ANALYSIS.md               # å¤±è´¥åˆ†ææŠ¥å‘Š(å¦‚æœ‰)
â”‚   â””â”€â”€ PERFORMANCE_METRICS.md            # æ€§èƒ½æŒ‡æ ‡æ€»ç»“
â””â”€â”€ metadata/
    â”œâ”€â”€ test_metadata.txt                  # æµ‹è¯•å…ƒæ•°æ®å’Œç¯å¢ƒä¿¡æ¯
    â”œâ”€â”€ execution_commands.log             # æ‰§è¡Œçš„å‘½ä»¤å†å²
    â”œâ”€â”€ terminal_outputs.log               # å®Œæ•´ç»ˆç«¯è¾“å‡ºè®°å½•
    â””â”€â”€ environment_snapshot.json          # æµ‹è¯•æ—¶çš„ç¯å¢ƒçŠ¶æ€å¿«ç…§
```

### å¿…å¤‡å½’æ¡£å†…å®¹æ¸…å•

#### æ¯æ¬¡æµ‹è¯•å¿…é¡»ä¿å­˜
1. **âœ… JSON æµ‹è¯•æŠ¥å‘Š**: æ‰€æœ‰å¸¦ `--output` å‚æ•°ç”Ÿæˆçš„ç»“æ„åŒ–ç»“æœæ–‡ä»¶
2. **âœ… ç»ˆç«¯è¾“å‡ºæ—¥å¿—**: å®Œæ•´çš„ PASS/FAIL ä¿¡æ¯ã€é”™è¯¯è¯¦æƒ…ã€æ‰§è¡Œæ—¶é—´
3. **âœ… æˆªå›¾æ–‡ä»¶**: æ‰€æœ‰å‰ç«¯æµ‹è¯•è‡ªåŠ¨ç”Ÿæˆçš„ PNG æˆªå›¾æ–‡ä»¶
4. **âœ… æ‰§è¡Œå‘½ä»¤è®°å½•**: å®é™…è¿è¡Œçš„å®Œæ•´å‘½ä»¤è¡Œå’Œç¯å¢ƒå˜é‡è®¾ç½®
5. **âœ… æµ‹è¯•å…ƒæ•°æ®**: æ‰§è¡Œæ—¶é—´ã€ç¯å¢ƒä¿¡æ¯ã€Gitæäº¤ä¿¡æ¯ã€æ‰§è¡Œè€…

#### æµ‹è¯•å…ƒæ•°æ®è®°å½•è„šæœ¬
```bash
# åœ¨æ¯æ¬¡æµ‹è¯•ä¼šè¯å¼€å§‹æ—¶æ‰§è¡Œ
ARTIFACT_DIR="artifacts/$(date +%Y-%m-%d)"
mkdir -p "$ARTIFACT_DIR/metadata"

# è®°å½•æµ‹è¯•å…ƒæ•°æ®
cat > "$ARTIFACT_DIR/metadata/test_metadata.txt" << EOF
æµ‹è¯•æ‰§è¡Œæ—¶é—´: $(date)
æµ‹è¯•æ‰§è¡Œè€…: $(whoami)
æ‰§è¡Œç¯å¢ƒ: $(uname -a)
Gitæäº¤å“ˆå¸Œ: $(git rev-parse HEAD)
Gitåˆ†æ”¯: $(git branch --show-current)
Pythonç‰ˆæœ¬: $(python3 --version)
Nodeç‰ˆæœ¬: $(node --version)
DockerçŠ¶æ€: $(docker ps --format "table {{.Names}}\t{{.Status}}" 2>/dev/null || echo "Dockerä¸å¯ç”¨")
æµ‹è¯•ç¯å¢ƒå˜é‡:
  VIBERESEARCH_BASE_URL=$VIBERESEARCH_BASE_URL
  VIBERESEARCH_FRONTEND_URL=$VIBERESEARCH_FRONTEND_URL
  VIBERESEARCH_TEST_EMAIL=$VIBERESEARCH_TEST_EMAIL
EOF

# è®°å½•ç¯å¢ƒçŠ¶æ€å¿«ç…§
curl -s "$VIBERESEARCH_BASE_URL/health" > "$ARTIFACT_DIR/metadata/health_snapshot.json" 2>/dev/null || echo '{"error":"backend_unavailable"}' > "$ARTIFACT_DIR/metadata/health_snapshot.json"
curl -s "$VIBERESEARCH_BASE_URL/info" > "$ARTIFACT_DIR/metadata/info_snapshot.json" 2>/dev/null || echo '{"error":"info_unavailable"}' > "$ARTIFACT_DIR/metadata/info_snapshot.json"
```

### æ‰§è¡Œå‘½ä»¤è®°å½•æ¨¡æ¿
```bash
# å¼€å§‹è®°å½•ä¼šè¯
script -a "$ARTIFACT_DIR/metadata/terminal_outputs.log"

# æˆ–è€…æ‰‹åŠ¨è®°å½•å…³é”®å‘½ä»¤
echo "=== $(date) ===" >> "$ARTIFACT_DIR/metadata/execution_commands.log"
echo "python3 scripts/backend_workflow_smoke.py --base-url $VIBERESEARCH_BASE_URL ..." >> "$ARTIFACT_DIR/metadata/execution_commands.log"
```

## âš ï¸ å¤±è´¥æ—¶çš„æŠ¥å‘Šæ¸…å•

### ç«‹å³æ”¶é›†ä¿¡æ¯ (å‘ç°å¤±è´¥å5åˆ†é’Ÿå†…)

#### 1. åŸºæœ¬å¤±è´¥ä¿¡æ¯
- **å¤±è´¥è„šæœ¬åç§°**: å…·ä½“çš„è„šæœ¬æ–‡ä»¶åå’Œå¤±è´¥æ­¥éª¤
- **æ‰§è¡Œå®Œæ•´å‘½ä»¤**: åŒ…å«æ‰€æœ‰å‚æ•°çš„å‘½ä»¤è¡Œ
- **å¤±è´¥æ—¶é—´**: ç²¾ç¡®çš„å¤±è´¥æ—¶é—´æˆ³
- **é”™è¯¯ç±»å‹**: HTTPçŠ¶æ€ç ã€è„šæœ¬é€€å‡ºç ã€å¼‚å¸¸ç±»å‹
- **é”™è¯¯æ¶ˆæ¯**: å®Œæ•´çš„error_codeã€messageå’Œdetailå­—æ®µ

#### 2. ç¯å¢ƒçŠ¶æ€å¿«ç…§æ”¶é›†
```bash
# ç«‹å³æ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ”¶é›†ç¯å¢ƒçŠ¶æ€
FAILURE_DIR="$ARTIFACT_DIR/failure_analysis_$(date +%H%M%S)"
mkdir -p "$FAILURE_DIR"

# æœåŠ¡çŠ¶æ€æ£€æŸ¥
curl -s "$VIBERESEARCH_BASE_URL/health" > "$FAILURE_DIR/health_at_failure.json"
curl -s "$VIBERESEARCH_BASE_URL/status" > "$FAILURE_DIR/status_at_failure.json"
curl -I "$VIBERESEARCH_BASE_URL" > "$FAILURE_DIR/connectivity_test.txt"
curl -I "$VIBERESEARCH_FRONTEND_URL" >> "$FAILURE_DIR/connectivity_test.txt"

# è¿›ç¨‹å’Œç«¯å£çŠ¶æ€
ps aux | grep -E "(uvicorn|npm|node)" > "$FAILURE_DIR/process_status.txt"
netstat -tuln | grep -E "(8000|3000)" > "$FAILURE_DIR/port_status.txt"
docker ps 2>/dev/null > "$FAILURE_DIR/docker_status.txt" || echo "Dockerä¸å¯ç”¨" > "$FAILURE_DIR/docker_status.txt"

# ç³»ç»Ÿèµ„æºçŠ¶æ€
df -h > "$FAILURE_DIR/disk_usage.txt"
free -h > "$FAILURE_DIR/memory_usage.txt"
uptime > "$FAILURE_DIR/system_load.txt"
```

#### 3. ç‰¹å®šç±»å‹å¤±è´¥çš„è¯¦ç»†æ”¶é›†

##### API æµ‹è¯•å¤±è´¥ (422/404/500)
**å¿…é¡»é™„åŠ æ”¶é›†**:
- å¤±è´¥è¯·æ±‚çš„å®Œæ•´ JSON payload
- `api_regression.json` ä¸­å¯¹åº”çš„å“åº”è¯¦æƒ…
- åŒç±»å‹å…¶ä»–ç«¯ç‚¹çš„æµ‹è¯•çŠ¶æ€å¯¹æ¯”
- æ•°æ®åº“è¿æ¥çŠ¶æ€ (å¦‚å¯è®¿é—®)

**æ”¶é›†è„šæœ¬**:
```bash
# APIå¤±è´¥ä¸“é¡¹æ”¶é›†
echo "=== APIå¤±è´¥è¯¦ç»†ä¿¡æ¯ ===" > "$FAILURE_DIR/api_failure_details.txt"
echo "å¤±è´¥ç«¯ç‚¹: [å…·ä½“APIè·¯å¾„]" >> "$FAILURE_DIR/api_failure_details.txt"
echo "HTTPçŠ¶æ€ç : [çŠ¶æ€ç ]" >> "$FAILURE_DIR/api_failure_details.txt"
echo "è¯·æ±‚payload:" >> "$FAILURE_DIR/api_failure_details.txt"
# ä»è„šæœ¬æ—¥å¿—ä¸­æå–å®é™…è¯·æ±‚å†…å®¹
echo "å“åº”è¯¦æƒ…:" >> "$FAILURE_DIR/api_failure_details.txt"
# ä»JSONæŠ¥å‘Šä¸­æå–å®Œæ•´å“åº”
```

##### å‰ç«¯æµ‹è¯•å¤±è´¥ (è¶…æ—¶/å…ƒç´ æœªæ‰¾åˆ°)
**å¿…é¡»é™„åŠ æ”¶é›†**:
- å¤±è´¥æ—¶çš„å®Œæ•´é¡µé¢æˆªå›¾
- æµè§ˆå™¨å¼€å‘è€…å·¥å…·æ§åˆ¶å°å®Œæ•´æ—¥å¿—
- é¡µé¢HTMLæºç å¿«ç…§
- ç½‘ç»œè¯·æ±‚ç€‘å¸ƒå›¾ (å¦‚å¯è·å–)

**æ”¶é›†è„šæœ¬**:
```bash
# å‰ç«¯å¤±è´¥ä¸“é¡¹æ”¶é›† (æ‰‹åŠ¨æ‰§è¡ŒPlaywrightè°ƒè¯•)
npx playwright test --debug --headed  # äº¤äº’å¼è°ƒè¯•æ¨¡å¼
# ç”Ÿæˆçš„traceæ–‡ä»¶å’Œæˆªå›¾ä¼šè‡ªåŠ¨ä¿å­˜åˆ°test-results/
cp frontend/test-results/* "$FAILURE_DIR/" 2>/dev/null
```

##### WebSocket æµ‹è¯•å¤±è´¥ (è¿æ¥å¤±è´¥/æ¶ˆæ¯å¼‚å¸¸)
**å¿…é¡»é™„åŠ æ”¶é›†**:
- WebSocketè¿æ¥å»ºç«‹è¿‡ç¨‹çš„è¯¦ç»†æ—¥å¿—
- æ¶ˆæ¯æ”¶å‘çš„å®Œæ•´æ—¶åºè®°å½•
- æœåŠ¡å™¨ç«¯WebSocketç›¸å…³æ—¥å¿— (å¦‚å¯è®¿é—®)

#### 4. æ ‡å‡†å¤±è´¥æŠ¥å‘Šæ¨¡æ¿

```markdown
# æµ‹è¯•å¤±è´¥æŠ¥å‘Š - [è„šæœ¬åç§°] - [æ—¥æœŸæ—¶é—´]

## ğŸ’¥ å¤±è´¥åŸºæœ¬ä¿¡æ¯
- **å¤±è´¥æ—¶é—´**: YYYY-MM-DD HH:MM:SS
- **å¤±è´¥è„šæœ¬**: scripts/[script_name]
- **æ‰§è¡Œå‘½ä»¤**: [å®Œæ•´å‘½ä»¤è¡Œ]
- **å¤±è´¥æ­¥éª¤**: [å…·ä½“æ­¥éª¤ï¼Œå¦‚ workspace_create]
- **é”™è¯¯ç±»å‹**: [HTTPçŠ¶æ€ç /è„šæœ¬é€€å‡ºç /å¼‚å¸¸ç±»å‹]

## ğŸ” é”™è¯¯è¯¦æƒ…
- **HTTPçŠ¶æ€ç **: [å¦‚ 422, 404, 500]
- **é”™è¯¯ä»£ç **: [å¦‚ VALIDATION_ERROR, HTTP_404]
- **é”™è¯¯æ¶ˆæ¯**: [å®Œæ•´çš„messageå­—æ®µ]
- **è¯¦ç»†ä¿¡æ¯**: [detailå­—æ®µå†…å®¹]

### å®Œæ•´å“åº”ä½“
```json
[ç²˜è´´å®Œæ•´çš„é”™è¯¯å“åº”JSON]
```

## ğŸ–¥ï¸ ç¯å¢ƒçŠ¶æ€
- **åç«¯å¥åº·æ£€æŸ¥**: [/healthç«¯ç‚¹å“åº”çŠ¶æ€]
- **å‰ç«¯å¯è®¿é—®æ€§**: [æ˜¯å¦èƒ½æ­£å¸¸è®¿é—®frontend URL]
- **æœåŠ¡è¿›ç¨‹çŠ¶æ€**: [uvicorn/npmè¿›ç¨‹æ˜¯å¦è¿è¡Œ]
- **ç«¯å£å ç”¨æƒ…å†µ**: [8000/3000ç«¯å£çŠ¶æ€]
- **Dockerå®¹å™¨çŠ¶æ€**: [ç›¸å…³å®¹å™¨è¿è¡ŒçŠ¶æ€]

## ğŸ”„ å¤ç°æ­¥éª¤
1. [ç¯å¢ƒå‡†å¤‡æ­¥éª¤]
2. [å…·ä½“æ‰§è¡Œå‘½ä»¤]
3. [å¤±è´¥ç°è±¡æè¿°]
4. [é¢„æœŸvså®é™…ç»“æœå¯¹æ¯”]

## ğŸ“Š ç›¸å…³æµ‹è¯•çŠ¶æ€
- **åŒæ‰¹æ¬¡å…¶ä»–æµ‹è¯•**: [å…¶ä»–è„šæœ¬æ‰§è¡ŒçŠ¶æ€]
- **å†å²å¯¹æ¯”**: [ä¸ä¸Šæ¬¡æˆåŠŸæ‰§è¡Œçš„å·®å¼‚]
- **ä¾èµ–æœåŠ¡çŠ¶æ€**: [æ•°æ®åº“/Redis/ESç­‰çŠ¶æ€]

## ğŸ’¡ ä¸´æ—¶è§£å†³æ–¹æ¡ˆ
[å¦‚æœ‰å¯è¡Œçš„ä¸´æ—¶ç»•è¿‡æ–¹æ³•]

## ğŸ“‹ é™„ä»¶æ¸…å•
- [x] å¤±è´¥æ—¶ç»ˆç«¯å®Œæ•´è¾“å‡º
- [x] ç¯å¢ƒçŠ¶æ€å¿«ç…§æ–‡ä»¶
- [x] å¤±è´¥æ­¥éª¤çš„æˆªå›¾ (å‰ç«¯æµ‹è¯•)
- [x] ç›¸å…³é…ç½®æ–‡ä»¶å†…å®¹
- [x] é”™è¯¯æ—¥å¿—æ–‡ä»¶ç‰‡æ®µ

## ğŸ·ï¸ åˆ†ç±»æ ‡ç­¾
- **ä¼˜å…ˆçº§**: [é«˜/ä¸­/ä½]
- **å½±å“èŒƒå›´**: [ç™»å½•/é¡¹ç›®ç®¡ç†/æ€§èƒ½/UIç­‰]
- **å¤±è´¥ç±»å‹**: [ç¯å¢ƒ/ä»£ç /é…ç½®/ç½‘ç»œç­‰]
- **é˜»å¡ç¨‹åº¦**: [å®Œå…¨é˜»å¡/éƒ¨åˆ†åŠŸèƒ½/ä¸å½±å“æ ¸å¿ƒæµç¨‹]
```

### å¤±è´¥åˆ†æå†³ç­–æ ‘

#### ç¯å¢ƒç›¸å…³å¤±è´¥
| ç—‡çŠ¶ | å¯èƒ½åŸå›  | ç«‹å³æ“ä½œ | å‡çº§è·¯å¾„ |
|------|----------|----------|----------|
| 401/403 é”™è¯¯ | Tokenè¿‡æœŸ/æƒé™ä¸è¶³ | é‡æ–°åˆ›å»ºæµ‹è¯•ç”¨æˆ· | æµ‹è¯•å›¢é˜Ÿå¤„ç† |
| 404 é”™è¯¯ | æœåŠ¡æœªå¯åŠ¨/è·¯ç”±é”™è¯¯ | æ£€æŸ¥æœåŠ¡çŠ¶æ€ï¼Œé‡å¯ | æµ‹è¯•å›¢é˜Ÿå¤„ç† |
| 500 é”™è¯¯ | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | æ”¶é›†æœåŠ¡å™¨æ—¥å¿— | ç ”å‘å›¢é˜Ÿä»‹å…¥ |
| è¶…æ—¶é”™è¯¯ | ç½‘ç»œ/æ€§èƒ½é—®é¢˜ | å¢åŠ timeoutï¼Œæ£€æŸ¥è´Ÿè½½ | æµ‹è¯•å›¢é˜Ÿå¤„ç† |
| å‰ç«¯ç™½å± | å‰ç«¯æœåŠ¡/æ„å»ºé—®é¢˜ | é‡å¯å‰ç«¯æœåŠ¡ | æµ‹è¯•å›¢é˜Ÿå¤„ç† |

#### æ•°æ®ç›¸å…³å¤±è´¥
| ç—‡çŠ¶ | å¯èƒ½åŸå›  | ç«‹å³æ“ä½œ | å‡çº§è·¯å¾„ |
|------|----------|----------|----------|
| é¡¹ç›®ä¸å­˜åœ¨ | æµ‹è¯•æ•°æ®è¢«æ¸…ç† | é‡æ–°æ‰§è¡Œé¡¹ç›®åˆ›å»º | æµ‹è¯•å›¢é˜Ÿå¤„ç† |
| ç”¨æˆ·ä¸å­˜åœ¨ | æ•°æ®åº“é‡ç½® | é‡æ–°æ³¨å†Œæµ‹è¯•ç”¨æˆ· | æµ‹è¯•å›¢é˜Ÿå¤„ç† |
| æƒé™ä¸è¶³ | ç”¨æˆ·è§’è‰²é…ç½® | æ£€æŸ¥ç”¨æˆ·æƒé™è®¾ç½® | ç ”å‘å›¢é˜Ÿä»‹å…¥ |
| æ•°æ®æ ¼å¼é”™è¯¯ | APIå˜æ›´ | æ”¶é›†æ–°æ—§æ ¼å¼å¯¹æ¯” | ç ”å‘å›¢é˜Ÿä»‹å…¥ |

#### åŠŸèƒ½ç›¸å…³å¤±è´¥
| ç—‡çŠ¶ | å¯èƒ½åŸå›  | ç«‹å³æ“ä½œ | å‡çº§è·¯å¾„ |
|------|----------|----------|----------|
| æ–°åŠŸèƒ½404 | æ¥å£æœªéƒ¨ç½² | ç¡®è®¤åŠŸèƒ½åˆ†æ”¯åˆå¹¶ | ç ”å‘å›¢é˜Ÿä»‹å…¥ |
| å­—æ®µç¼ºå¤± | APIå“åº”æ ¼å¼å˜æ›´ | å¯¹æ¯”æ–‡æ¡£æœŸæœ› | ç ”å‘å›¢é˜Ÿä»‹å…¥ |
| UIå…ƒç´ ä¸å­˜åœ¨ | å‰ç«¯å˜æ›´ | æ›´æ–°æµ‹è¯•é€‰æ‹©å™¨ | æµ‹è¯•å›¢é˜Ÿå¤„ç† |
| æ€§èƒ½æ˜¾è‘—é™ä½ | ä»£ç /æ•°æ®é—®é¢˜ | æ€§èƒ½åˆ†ææŠ¥å‘Š | ç ”å‘å›¢é˜Ÿä»‹å…¥ |

## 6. æ‰‹åŠ¨è¡¥å……éªŒè¯ï¼ˆå¿…è¦æ—¶ï¼‰
è‡ªåŠ¨åŒ–è¦†ç›–ä¹‹å¤–ï¼Œå»ºè®®åœ¨ staging ç¯å¢ƒæ‰‹åŠ¨å·¡æ£€ï¼š
1. **æ¨¡å‹å¼€å…³ä¸é™çº§ç­–ç•¥**ï¼šåœ¨ç®¡ç†é¢æ¿åˆ‡æ¢è½»é‡/æ ‡å‡†/æ·±åº¦æ¨¡å¼ï¼Œç¡®è®¤å‰ç«¯æ•°æ®é¢æ¿ä¸ä»»åŠ¡æ’é˜Ÿè¡Œä¸ºåŒæ­¥æ›´æ–°ã€‚
2. **WebSocket / SSE**ï¼šè‹¥ Playwright æŠ¥è­¦ï¼Œä½¿ç”¨ `scripts/test_websocket_final.py` å•ç‹¬éªŒè¯ã€‚
3. **å¤§æ–‡çŒ®åº“æµç¨‹**ï¼šè°ƒç”¨ `scripts/test_integration.sh` æˆ– Celery worker åœºæ™¯ï¼Œç¡®è®¤é•¿è€—æ—¶ä»»åŠ¡æ²¡æœ‰é˜»å¡ã€‚
4. **æ‰¹é‡å¯¼å…¥/å¯¼å‡º**ï¼šä¾èµ–çœŸå®å¤–éƒ¨æœåŠ¡ï¼ˆå¦‚ Elasticsearchï¼‰çš„åŠŸèƒ½éœ€åœ¨å…¨é‡ç¯å¢ƒæ‰§è¡Œï¼Œå¹¶è®°å½•æ•°æ®åº“/ç´¢å¼•çŠ¶æ€å¿«ç…§ã€‚

## 7. éªŒæ”¶ä¸æ±‡æŠ¥
- **ä¸Šçº¿æ¡ä»¶**ï¼šæ‰€æœ‰è‡ªåŠ¨åŒ–æ­¥éª¤é€šè¿‡ï¼ˆé€€å‡ºç  0ï¼‰ï¼ŒPlaywright æŠ¥å‘Šæ— å¤±è´¥ï¼Œ`api_regression.json` ä¸­æ—  `FAIL/ERROR` è®°å½•ã€‚
- **æ±‡æŠ¥æ¨¡ç‰ˆ**ï¼š
  1. æ‰§è¡Œæ—¶é—´ & `RUN_ID`
  2. å…³é”®è„šæœ¬ï¼ˆpytest / api_regression / playwrightï¼‰çŠ¶æ€
  3. å¤±è´¥æ•°ä¸º 0 æˆ–åˆ—å‡ºå¤±è´¥æ¸…å•
  4. é™„ `summary.log` ä¸å¿…è¦æˆªå›¾/æ—¥å¿—
- **æŒç»­é›†æˆ**ï¼šå»ºè®®åœ¨ CI ä¸­é…ç½®æ¯æ—¥æ„å»ºï¼Œä½¿ç”¨åŒä¸€è„šæœ¬å¹¶ä¿ç•™ `artifacts/system_tests` ç›®å½•ï¼Œå®ç°å¯è¿½æº¯çš„å†å²å¯¹æ¯”ã€‚

## 8. æ‰©å±•è¦†ç›–è·¯çº¿å›¾
ä¸ºåº”å¯¹åç»­ç‰ˆæœ¬åŠç»†èŠ‚åŠŸèƒ½ï¼Œè‡ªåŠ¨åŒ–ä½“ç³»å°†æŒ‰ç…§ã€ŒAPI æ·±åº¦ â†’ å‰ç«¯æ—…ç¨‹ â†’ åœºæ™¯è”è°ƒã€åˆ†é˜¶æ®µæ¨è¿›ã€‚æ‰€æœ‰æ–°å¢è„šæœ¬ä¼šè½åœ¨æ—¢æœ‰æ¡†æ¶ä¸Šï¼Œæ‰§è¡Œå…¥å£ä¿æŒä¸å˜ã€‚

### 8.1 åç«¯ API è¡¥å¼º
- **åˆ†æ/ç ”ç©¶ä»»åŠ¡**ï¼š`scripts/api_regression_suite.py` æ–°å¢ `test_analysis_endpoints()`ï¼Œè¦†ç›– `/api/analysis/ask-question`ã€`/generate-experience`ã€`/generate-main-experience`ã€`/generate-ideas`ï¼Œå¹¶è‡ªåŠ¨è®°å½•ç”Ÿæˆçš„ä»»åŠ¡ä»¥ä¾¿æ¸…ç†ã€‚
- **ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸ**ï¼šå›å½’è„šæœ¬ä¼šæ•è·ç”±æ·±åº¦/è‡ªåŠ¨æ¨¡å¼äº§ç”Ÿçš„ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ `/api/task/{id}/cancel`ï¼ŒéªŒè¯é‡æ”¾/å–æ¶ˆè·¯å¾„å¯ç”¨ã€‚
- **è®¡åˆ’ä¸­çš„è¡¥å……**ï¼š
  - æ–‡çŒ®ä¸Šä¼ ä¸ç´¢å¼•ï¼ˆé¢„å¤‡ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶ + SQLite å¼€å…³ï¼‰
  - åä½œå›¢é˜Ÿå¢åˆ æ”¹ï¼ˆéœ€å¼•å…¥æµ‹è¯•ç”¨å›¢é˜Ÿæˆå‘˜ï¼‰
  - é€šçŸ¥ã€ä¼šå‘˜å‡çº§ã€å¯†ç é‡ç½®ç­‰ç”¨æˆ·è®¾ç½®æ¥å£

æ‰§è¡Œæ–¹å¼ä¿æŒä¸å˜ï¼Œä»é€šè¿‡ `./scripts/run_full_system_suite.sh` è°ƒåº¦ï¼›åªéœ€å…³æ³¨ `integration/api_regression.json` çš„æ–°å¢æ¡ç›®å’Œæ½œåœ¨ `WARN` è®°å½•ã€‚

### 8.2 å‰ç«¯æ—…ç¨‹æ‰©å±•
- **å¯¼èˆªæ ¡éªŒ**ï¼šPlaywright `main feature navigation test` å·²è¦†ç›–ã€Œä»ªè¡¨ç›˜ / ç ”ç©¶å·¥ä½œå° / æ–‡çŒ®åº“ / ä»»åŠ¡ä¸­å¿ƒã€å››ä¸ªä¸»èœå•ï¼Œå¹¶åŸºäºé¡µé¢æ ‡é¢˜éªŒè¯åŠ è½½æˆåŠŸã€‚
- **å·¥ä½œå°ç©ºæ€æ£€æµ‹**ï¼š`workspace guidance state test` ç¡®è®¤æ— é¡¹ç›®æ—¶çš„å¼•å¯¼æç¤ºï¼Œç¡®ä¿æç¤ºæ¶ˆæ¯ä¸ä¼šæ¶ˆå¤±ã€‚
- **è®¡åˆ’ä¸­çš„æ—…ç¨‹**ï¼š
  1. ç ”ç©¶å·¥ä½œå°ï¼šè‡ªåŠ¨æ¨¡å¼å‘èµ·æŸ¥è¯¢ â†’ ä»»åŠ¡çŠ¶æ€æ›´æ–° â†’ ç»“æœé¢æ¿å¿«ç…§ã€‚
  2. æ–‡çŒ®åº“ï¼šå¯¼å…¥ç¤ºä¾‹ PDFã€ç­›é€‰ã€åˆ‡æ¢å¡ç‰‡/è¡¨æ ¼è§†å›¾ã€‚
  3. ä»»åŠ¡ä¸­å¿ƒï¼šå–æ¶ˆ/é‡è¯•æŒ‰é’®å¯ç”¨æ€§ã€æŠ½å±‰è¯¦æƒ…å±•ç¤ºã€‚
  4. ä¸»é¢˜åˆ‡æ¢ä¸é€šçŸ¥ï¼šéªŒè¯å…‰/æš—æ¨¡å¼åŠæ¶ˆæ¯æé†’ã€‚

> Playwright ä»é€šè¿‡ `npm run lint && npm run build && npx playwright test` è¿è¡Œã€‚è‹¥éœ€å¯¹æ¯”å¤šè½®ç»“æœï¼Œå¯è®¾ç½® `RUN_ID=... PLAYWRIGHT_RUN_ID=... ./scripts/run_full_system_suite.sh` ä¿æŒäº§ç‰©ç›®å½•ä¸€è‡´ã€‚

### 8.3 æ‰‹åŠ¨éªŒè¯è¡¥å……
- åä½œå·¥ä½œå°ã€MCP å·¥å…·é“¾ã€WebSocket å®æ—¶äº‹ä»¶ä»éœ€äººå·¥å·¡æ£€ï¼Œå¾…ç¨³å®šæ•°æ®ä¸ Mock æ¡†æ¶å°±ç»ªåå†çº³å…¥è‡ªåŠ¨åŒ–ã€‚
- æ‰€æœ‰æ–°å¢è‡ªåŠ¨åŒ–è„šæœ¬å‡ä¼šåœ¨ `REGRESSION_PROOF.md` ä¸­è·Ÿè¸ªã€Œå·²è¦†ç›–/å¾…è¦†ç›–ã€çŠ¶æ€ï¼Œä¾¿äº QA ç­¾å­—ã€‚

---
å¦‚éœ€æ‰©å±•æµ‹è¯•èŒƒå›´ï¼Œå¯åœ¨ `scripts/run_full_system_suite.sh` ä¸­æ–°å¢æ­¥éª¤ï¼Œæˆ–æ‰©å…… `scripts/api_regression_suite.py` çš„ç«¯ç‚¹åˆ—è¡¨ï¼›è¯·åŒæ­¥æ›´æ–°æœ¬æŒ‡å—ï¼Œç¡®ä¿æµ‹è¯•å›¢é˜ŸæŒæ¡æœ€æ–°è¦†ç›–é¢ã€‚
